
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>02. Extract receipt text Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="03-BACKGROUND-PROCESSING.html" />
    
    
    <link rel="prev" href="01-UPLOAD-RECEIPTS.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../WARMUPS.html">
            
                <a href="../WARMUPS.html">
            
                    
                    Warmups
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../day-1/">
            
                <a href="../day-1/">
            
                    
                    Day 1
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../day-1/1-SETUP.html">
            
                <a href="../day-1/1-SETUP.html">
            
                    
                    01. Setup your AWS Account
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../day-1/2-LAMBDA.html">
            
                <a href="../day-1/2-LAMBDA.html">
            
                    
                    02. Serverless app with AWS Lambda
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../day-1/3-CLOUDFORMATION.html">
            
                <a href="../day-1/3-CLOUDFORMATION.html">
            
                    
                    03. CloudFormation Infra as Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../day-1/4-APIGW.html">
            
                <a href="../day-1/4-APIGW.html">
            
                    
                    04. APIs withs API Gateway
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../day-1/5-DEBUG.html">
            
                <a href="../day-1/5-DEBUG.html">
            
                    
                    05. Debugging serverless apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../day-1/6-DYNAMODB.html">
            
                <a href="../day-1/6-DYNAMODB.html">
            
                    
                    06. DynamoDB a serverless database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../day-1/7-TESTING.html">
            
                <a href="../day-1/7-TESTING.html">
            
                    
                    07. Designing Testable Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../day-1/8-CICD.html">
            
                <a href="../day-1/8-CICD.html">
            
                    
                    08. CI/CD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../day-1/9-DEPLOYMENT.html">
            
                <a href="../day-1/9-DEPLOYMENT.html">
            
                    
                    09. Deployment preferences
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    Day 2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="01-UPLOAD-RECEIPTS.html">
            
                <a href="01-UPLOAD-RECEIPTS.html">
            
                    
                    01. Upload receipts
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.2" data-path="02-EXTRACT-RECEIPT-TEXT.html">
            
                <a href="02-EXTRACT-RECEIPT-TEXT.html">
            
                    
                    02. Extract receipt text
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="03-BACKGROUND-PROCESSING.html">
            
                <a href="03-BACKGROUND-PROCESSING.html">
            
                    
                    03. Performance optimization - background processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="04-COLD-START.html">
            
                <a href="04-COLD-START.html">
            
                    
                    04. Performance optimization - latency and cold starts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="05-NO-LAMBDA.html">
            
                <a href="05-NO-LAMBDA.html">
            
                    
                    05. Performance optimization - skip Lambdas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="06-STREAMING.html">
            
                <a href="06-STREAMING.html">
            
                    
                    06. Serverless streaming patterns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="07-ORCHESTRATION.html">
            
                <a href="07-ORCHESTRATION.html">
            
                    
                    07. Orchestration using Step functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="08-MIGRATION.html">
            
                <a href="08-MIGRATION.html">
            
                    
                    08. The Enterprise Migration Path to Serverless
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="09-WARDLEY-MAPS.html">
            
                <a href="09-WARDLEY-MAPS.html">
            
                    
                    09. Build or outsource - Designing a Serverless Architecture with Wardley Maps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="10-SERVERLESS-FOR-CFOS.html">
            
                <a href="10-SERVERLESS-FOR-CFOS.html">
            
                    
                    10. Business case for refactoring
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../CONCLUSION.html">
            
                <a href="../CONCLUSION.html">
            
                    
                    Conclusion
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >02. Extract receipt text</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="extract-receipt-text">Extract receipt text</h1>
<p>Now that we have the upload and archiving part, it&apos;s time to use OCR and read the expense amount and date from receipt photos. But what&apos;s a good OCR service for our serverless application?</p>
<p>We can connect a serverless application to almost any third-party service. However, if we are not careful, we can hit a rate limit or crash the third-party service we use. Also, we need to make sure our app has all the permissions to talk to the external application.</p>
<p>As you can guess, there&apos;s an AWS service for that. As part of its <a href="https://aws.amazon.com/machine-learning/" target="_blank">rich AI and ML offering</a>, AWS offers <a href="https://aws.amazon.com/textract/" target="_blank">Amazon Textract</a>, a service that automatically extracts text and data from scanned documents. Textract goes beyond simple optical character recognition (OCR) to also identify the contents of fields in forms and information stored in tables.</p>
<h2 id="task">Task</h2>
<p>Your task in this exercise is to send a photo customer uploads to Amazon Textract, get the data, and store the expense details to our DynamoDB table.</p>
<p>To do that you&apos;ll need the following steps:</p>
<ol>
<li>Use AWS SDK to upload a photo to Amazon Textract.</li>
<li>Get the data, and extract the date and amount info.</li>
<li>Save the amount and date to the DynamoDB table.</li>
</ol>
<p>Once you complete this exercise, take a minute and discuss the limitations of your solution with your team. Here are a few questions you can try to answer:</p>
<ul>
<li>How does Amazon Textract affects function duration?</li>
<li>What would be more optimal solution?</li>
</ul>
<h2 id="hint">Hint</h2>
<p>Here are a few hints to help you with this task:</p>
<ol>
<li>Use the <code>textract.analyzeDocument</code> method of <a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/Textract.html#analyzeDocument-property" target="_blank">AWS SDK</a> to analyze the document.</li>
<li>You can enable or disable form and table recognition using <code>FeatureTypes</code> parameter of the <code>textract.analyzeDocument</code> method.</li>
<li>Make sure your function has permission to analyze the document using Amazon Textract. There&apos;s no managed SAM policy template for Textract, but you can add <a href="https://docs.aws.amazon.com/textract/latest/dg/api-permissions-reference.html" target="_blank">a required permission</a> manually.</li>
</ol>
<div class="accordion accordionClose"><div class="accordionButton"><div class="accordionTitle">Need more help? Here are some code samples.</div><div class="accordionSpinnerBox"><div class="accordionSpinner"></div></div></div><div class="accordionContent">
<p>Here&apos;s a piece of Node.js code that invokes Amazon Textract to analyze the document:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getReceiptData</span>(<span class="hljs-params">fileBuffer, textract</span>) </span>{
  <span class="hljs-keyword">const</span> params = {
    Document: {
      Bytes: fileBuffer <span class="hljs-comment">// An uploaded photo as a buffer</span>
    },
    FeatureTypes: [<span class="hljs-string">&apos;FORMS&apos;</span>, <span class="hljs-string">&apos;TABLES&apos;</span>] <span class="hljs-comment">// Get both forms and tables</span>
  };

  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> textract.analyzeDocument(params).promise();
  <span class="hljs-comment">// Get the data from the Textract result</span>
  <span class="hljs-keyword">const</span> receiptData = extractData(response);
  <span class="hljs-keyword">return</span> receiptData;
}
</code></pre>
</div></div>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="01-UPLOAD-RECEIPTS.html" class="navigation navigation-prev " aria-label="Previous page: 01. Upload receipts">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="03-BACKGROUND-PROCESSING.html" class="navigation navigation-next " aria-label="Next page: 03. Performance optimization - background processing">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"02. Extract receipt text","level":"1.4.2","depth":2,"next":{"title":"03. Performance optimization - background processing","level":"1.4.3","depth":2,"path":"day-2/03-BACKGROUND-PROCESSING.md","ref":"day-2/03-BACKGROUND-PROCESSING.md","articles":[]},"previous":{"title":"01. Upload receipts","level":"1.4.1","depth":2,"path":"day-2/01-UPLOAD-RECEIPTS.md","ref":"day-2/01-UPLOAD-RECEIPTS.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["page-toc","accordion"],"pluginsConfig":{"page-toc":{"selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","position":"before-first","showByDefault":true},"accordion":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"day-2/02-EXTRACT-RECEIPT-TEXT.md","mtime":"2020-02-25T18:10:27.112Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-02-28T08:17:42.016Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

